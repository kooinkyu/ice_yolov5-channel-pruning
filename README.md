# YOLOv5 기반 채널 프루닝을 이용한 실시간 운전자 상태 인식 시스템

본 저장소는 실시간 운전자 상태 인식(Driver Monitoring System, DMS)을 목적으로,  
YOLOv5 객체 검출 모델에 구조적 경량화 기법(Channel Pruning)을 적용한 연구 결과를 정리한 GitHub 저장소이다.

본 연구는 한국외국어대학교 정보통신공학과 졸업논문  
「YOLOv5 기반 채널 프루닝을 이용한 실시간 운전자 상태 인식 시스템」의 실험 및 구현 내용을 기반으로 한다.

- 저자: 구인규, 김재하, 도준호  
- 지도교수: 한희일 교수님  

---

## 연구 배경 및 목적

운전자 상태 인식 시스템은 졸음, 주의 산만 등의 위험 상태를 조기에 감지하여 교통사고를 예방하는 핵심 기술이다.  
최근 YOLO 계열 객체 검출 모델은 조명 변화, 얼굴 각도 변화에 강인한 특성으로 DMS 분야에서 활발히 활용되고 있다.

그러나 YOLOv5s 모델 또한 차량용 임베디드 환경에서는 다음과 같은 한계를 가진다.

- 제한된 연산 자원 및 메모리 환경
- 실시간 추론을 위한 지연 시간 요구
- 다수 카메라 입력 환경에서의 연산 부담

본 연구의 목적은 **YOLOv5의 구조를 유지하면서도**,  
임베디드 환경에 적합한 수준으로 **모델 연산량과 파라미터 수를 감소**시키는 것이다.

---

## 연구 기여도

본 연구의 주요 기여는 다음과 같다.

- YOLOv5 구조를 기반으로 한 **2단계 경량화 파이프라인 제안**
- YAML 설정 기반의 구조적 채널 축소
- L2-norm 기반의 **구조적 채널 프루닝(Channel Pruning)** 적용
- 브랜치 및 Concat 구조를 고려한 **의존성 보존 프루닝**
- Batch Normalization 재보정 및 미세 조정을 통한 성능 복원
- 소형 얼굴 영역(눈, 입) 검출 기반 DMS 환경에서의 성능 검증

---

## 제안 방법 개요

### 1. YAML 기반 구조 축소 (Structural Downsizing)

YOLOv5는 모델 구조를 YAML 파일로 정의하며, 다음과 같은 전역 스케일링 파라미터를 제공한다.

```yaml
depth_multiple: 0.33
width_multiple: 0.40
```

이를 통해 네트워크의 깊이와 채널 수를 전반적으로 감소시키면서도,  
Backbone–Neck–Head로 구성된 YOLOv5의 기본 구조는 그대로 유지할 수 있다.

해당 단계는 이후 채널 프루닝을 적용하기 위한 **경량화 기반 모델**을 생성하는 역할을 하며,  
모델 파라미터 수와 연산량을 효과적으로 감소시키면서 성능 저하를 최소화한다.

---

### 2. L2-norm 기반 채널 프루닝

구조 축소가 적용된 모델을 대상으로, 각 합성곱 계층의 출력 채널에 대해  
가중치의 L2-norm을 계산하여 채널 중요도를 평가한다.

- 중요도가 낮은 채널부터 제거
- 프루닝 비율: 30%
- Concat 및 Skip Connection 구조를 고려하여 채널 의존성 유지
- Detection Head 계층은 프루닝 대상에서 제외

프루닝 이후에는 다음과 같은 후처리 과정을 수행한다.

- Batch Normalization 파라미터 재보정
- 낮은 학습률 기반의 미세 조정(Fine-tuning)

이를 통해 프루닝으로 인해 발생할 수 있는 성능 저하를 효과적으로 복원한다.

---

## 데이터셋 구성

본 연구에서는 **AI Hub 졸음운전 데이터셋**을 활용하였다.  
해당 데이터셋은 실제 주행 환경과 통제 환경을 포함하여 다양한 운전자 상태를 포함한다.

### 클래스 구성 (총 6개)

| ID | 클래스 |
|----|--------|
| 0 | Leye_Open |
| 1 | Leye_Closed |
| 2 | Reye_Open |
| 3 | Reye_Closed |
| 4 | Mouth_Open |
| 5 | Mouth_Closed |

### 데이터 환경

- 실제 도로 환경
- 통제 환경
- 준통제 환경

JSON 형식의 어노테이션 데이터를 YOLO 포맷으로 변환하여 학습에 사용하였다.  
데이터 전처리 과정에서는 잘못된 라벨 및 비정상 바운딩 박스를 제거하였다.

※ 데이터셋은 라이선스 정책에 따라 본 저장소에 포함되어 있지 않다.

---

## 실험 환경 및 설정

- 딥러닝 프레임워크: PyTorch
- 입력 이미지 해상도: 640 × 640
- 평가 지표: Precision, Recall, mAP@50, mAP@50–95
- 비교 모델:
  - YOLOv5s (기본 모델)
  - YAML 기반 구조 축소 모델
  - 채널 프루닝 적용 모델
  - YOLOv5n

모든 모델은 동일한 학습 및 평가 조건에서 비교 실험을 수행하였다.

---

## 실험 결과 요약

실험 결과, 제안한 채널 프루닝 모델은 다음과 같은 성능을 보였다.

- 모델 파라미터 수 및 FLOPs **약 50% 이상 감소**
- YOLOv5s 대비 **mAP@50 성능 저하 1% 이내**
- YOLOv5n 대비 유의미하게 높은 검출 성능 유지
- 실시간 추론 환경에 적합한 지연 시간 확보

이를 통해 제안한 방법이  
**정확도와 연산 효율 간의 균형을 효과적으로 달성함**을 확인하였다.

---

## 재현성 안내

- 데이터 전처리 스크립트 및 데이터셋 YAML 설정 파일 포함
- 모델 구조 및 채널 프루닝 로직은 결정론적으로 구현됨
- 동일한 환경에서 실험 재현 가능하도록 코드 구성

---

## 참고 및 라이선스

- 데이터셋: AI Hub (원본 라이선스 정책 준수)
- 본 저장소는 연구 및 학술 목적의 활용을 전제로 한다.

---

